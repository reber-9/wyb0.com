<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>信息泄露 on </title>
    <link>http://wyb0.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</link>
    <description>Recent content in 信息泄露 on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Thu, 28 Jul 2016 22:42:58 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/tags/%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>敏感信息泄露</title>
      <link>http://wyb0.com/posts/%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</link>
      <pubDate>Thu, 28 Jul 2016 22:42:58 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/</guid>
      <description>

&lt;h3 id=&#34;0x00-软件敏感信息:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x00 软件敏感信息&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* 操作系统版本
    可用namp扫描得知
* 中间件的类型、版本
    http返回头
    404报错页面
    使用工具(如whatweb)
* Web程序(cms类型及版本、敏感文件)
    可用whatweb、cms_identify
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-web敏感信息:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x01 Web敏感信息&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* phpinfo()信息泄露
    http://[ip]/test.php和http://[ip]/phpinfo.php
* 测试页面泄露在外网
    test.cgi、phpinfo.php、info.php等
* 编辑器备份文件泄露在外网
    http://[ip]/.test.php.swp
    http://[ip]/test.php.bak
    http://[ip]/test.jsp.old
    http://[ip]/cgi~
    常见编辑器备份后缀
* 版本管理工具(如git)文件信息泄露
    http://[ip]/.git/config
    http://[ip]/CVS/Entriesp
    http://[ip]/.svn/entriesp
* HTTP认证泄露漏洞
    http://[ip]/basic/index.php
    Web目录开启了HTTP Basic认证，但未限制IP，导致可暴力破解账号、密码
* 管理后台地址泄露
    http://[ip]/login.php
    http://[ip]/admin.php
    http://[ip]/manager.php
    http://[ip]/admin_login.php
* 泄露员工邮箱、分机号码
    泄露邮箱及分机号码可被社工，也可生成字典
* 错误页面暴漏信息
    mysql错误、php错误、暴漏cms版本等
* 探针文件
* robots.txt
* phpMyAdmin
* 网站源码备份文件(www.rar/sitename.tar.gz/web/zip等)
* 其他
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-网络信息泄露:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x02 网络信息泄露&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* DNS域传送漏洞
* 运维监控系统弱口令、网络拓扑泄露
    zabbix弱口令、zabbix sql注入等
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x03-第三方软件应用:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x03 第三方软件应用&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* github上源码、数据库、邮箱密码泄露
    搜类似：smtp 163 password关键字
* 百度网盘被员工不小心上传敏感文件
* QQ群被员工不小心上传敏感文件
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x04-敏感信息搜集工具:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x04 敏感信息搜集工具&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;https://github.com/ring04h/weakﬁlescan
https://github.com/lijiejie/BBScan
whatweb
dnsenum
github
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x05-示例:ce7edaccf7b701fbd596798448fa72c4&#34;&gt;0x05 示例&lt;/h3&gt;

&lt;blockquote&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/sensitive_information_leakage.png&#34; alt=&#34;敏感信息泄露.png&#34;&gt;
&lt;/div&gt;

&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>任意文件查看与下载漏洞</title>
      <link>http://wyb0.com/posts/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%9F%A5%E7%9C%8B%E4%B8%8E%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/</link>
      <pubDate>Wed, 27 Jul 2016 23:25:18 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%9F%A5%E7%9C%8B%E4%B8%8E%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/</guid>
      <description>

&lt;h3 id=&#34;0x00-漏洞介绍:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x00 漏洞介绍&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;一些网站由于业务需求，往往需要提供文件查看或文件下载功能，但若对用户查看或下载的文件
不做限制，则恶意用户就能够查看或下载任意敏感文件，这就是文件查看与下载漏洞
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-利用条件:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x01 利用条件&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* 存在读文件的函数
* 读取文件的路径用户可控且未校验或校验不严
* 输出了文件内容
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-漏洞危害:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x02 漏洞危害&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;下载服务器任意文件，如脚本代码、服务及系统配置文件等
可用得到的代码进一步代码审计，得到更多可利用漏洞
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x03-任意文件读取:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x03 任意文件读取&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;代码形式可如下几种：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php
    $filename = &amp;quot;test.txt&amp;quot;;
    readfile($filename);
?&amp;gt;

&amp;lt;?php
    $filename = &amp;quot;test.txt&amp;quot;;

    $fp = fopen($filename,&amp;quot;r&amp;quot;) or die(&amp;quot;Unable to open file!&amp;quot;);
    $data = fread($fp,filesize($filename));
    fclose($fp);

    echo &amp;quot;&amp;lt;pre&amp;gt;&amp;quot;;
        print_r(htmlspecialchars($data));
    echo &amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;;
?&amp;gt;

&amp;lt;?php
    $filename = &amp;quot;test.txt&amp;quot;;
    $data = file_get_contents($filename);

    echo &amp;quot;&amp;lt;pre&amp;gt;&amp;quot;;
        print_r(htmlspecialchars($data));
    echo &amp;quot;&amp;lt;/pre&amp;gt;&amp;quot;;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x04-任意文件下载:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x04 任意文件下载&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;直接下载：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;a href=&amp;quot;http://www.xx.com/a.zip&amp;quot;&amp;gt;Download&amp;lt;/a&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;用header()下载：&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;&amp;lt;?php
    $filename = &amp;quot;uploads/201607141437284653.jpg&amp;quot;;

    header(&#39;Content-Type: imgage/jpeg&#39;);
    header(&#39;Content-Disposition: attachment; filename=&#39;.$filename);
    header(&#39;Content-Lengh: &#39;.filesize($filename));
    readfile($filename);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x05-漏洞利用代码:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x05 漏洞利用代码&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code class=&#34;language-php&#34;&gt;readfile.php?file=/etc/passwd
readfile.php?file=../../../../../../../../etc/passwd
readfile.php?file=../../../../../../../../etc/passwd%00
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x06-google-search:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x06 Google search&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;inurl:&amp;quot;readfile.php?file=&amp;quot;
inurl:&amp;quot;read.php?filename=&amp;quot;
inurl:&amp;quot;download.php?file=&amp;quot;
inurl:&amp;quot;down.php?file=&amp;quot;
等等...
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x07-漏洞挖掘:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x07 漏洞挖掘&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;可以用Google hacking或Web漏洞扫描器
从链接上看，形如：
    • readfile.php?file=***.txt
    • download.php?file=***.rar
从参数名看，形如：
    • &amp;amp;RealPath= 
    • &amp;amp;FilePath= 
    • &amp;amp;ﬁlepath= 
    • &amp;amp;Path= 
    • &amp;amp;path= 
    • &amp;amp;inputFile= 
    • &amp;amp;url= 
    • &amp;amp;urls= 
    • &amp;amp;Lang= 
    • &amp;amp;dis= 
    • &amp;amp;data= 
    • &amp;amp;readﬁle= 
    • &amp;amp;ﬁlep= 
    • &amp;amp;src= 
    • &amp;amp;menu= 
    • META-INF 
    • WEB-INF
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x08-敏感文件如下:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x08 敏感文件如下&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;Windows：
    C:\boot.ini  //查看系统版本
    C:\Windows\System32\inetsrv\MetaBase.xml  //IIS配置文件
    C:\Windows\repair\sam  //存储系统初次安装的密码
    C:\Program Files\mysql\my.ini  //Mysql配置
    C:\Program Files\mysql\data\mysql\user.MYD  //Mysql root
    C:\Windows\php.ini  //php配置信息
    C:\Windows\my.ini  //Mysql配置信息
    ...
Linux：
    /root/.ssh/authorized_keys
    /root/.ssh/id_rsa
    /root/.ssh/id_ras.keystore
    /root/.ssh/known_hosts
    /etc/passwd
    /etc/shadow
    /etc/my.cnf
    /etc/httpd/conf/httpd.conf
    /root/.bash_history
    /root/.mysql_history
    /proc/self/fd/fd[0-9]*(文件标识符)
    /proc/mounts
    /porc/config.gz
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x09-漏洞验证:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x09 漏洞验证&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;• index.php?f=../../../../../../etc/passwd 
• index.php?f=../index.php 
• index.php?f=ﬁle:///etc/passwd
注：当参数f的参数值为php文件时，若是文件被解析则是文件包含漏洞，
    若显示源码或提示下载则是文件查看与下载漏洞
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x0a-修复方案:2eb0c8ca765cdf9232aa4561a747da6f&#34;&gt;0x0A 修复方案&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;* 过滤点(.)，使用户在url中不能回溯上级目录
* 正则严格判断用户输入参数的格式
* php.ini配置open_basedir限定文件访问范围
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
  </channel>
</rss>