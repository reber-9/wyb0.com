<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Redis on </title>
    <link>http://wyb0.com/tags/redis/</link>
    <description>Recent content in Redis on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Wed, 03 Aug 2016 15:52:26 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/tags/redis/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Redis未授权访问漏洞</title>
      <link>http://wyb0.com/posts/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/</link>
      <pubDate>Wed, 03 Aug 2016 15:52:26 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/Redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/</guid>
      <description>

&lt;h3 id=&#34;0x00-redis的未授权访问:d1ccae2911ccb06e919f49f6d8ad332d&#34;&gt;0x00 Redis的未授权访问&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;若Redis服务器对公网开放，且未启用认证，则攻击者可以未授权访问服务器。
若Redis以root身份运行，黑客可以给root账户写入SSH公钥文件，通过SSH登录受害服务器。
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-向redis服务器上传ssh公钥:d1ccae2911ccb06e919f49f6d8ad332d&#34;&gt;0x01 向Redis服务器上传SSH公钥&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_create_keys.png&#34; alt=&#34;本地生成SSH密钥对&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_export_pubkey.png&#34; alt=&#34;本地生成SSH密钥对&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_write_pubkey.png&#34; alt=&#34;将本地生成的公钥写到对方服务器上&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_use_sshkey_login.png&#34; alt=&#34;本地通过私钥登陆对方服务器&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-通过计划任务反弹shell:d1ccae2911ccb06e919f49f6d8ad332d&#34;&gt;0x02 通过计划任务反弹shell&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_write_cron.png&#34; alt=&#34;通过Redis向对方服务器写计划任务反弹shell&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_unauthorized_access_listen_port.png&#34; alt=&#34;本地监听服务器反弹的那个端口&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>Redis的安装</title>
      <link>http://wyb0.com/posts/Redis%E7%9A%84%E5%AE%89%E8%A3%85/</link>
      <pubDate>Wed, 03 Aug 2016 00:00:48 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/Redis%E7%9A%84%E5%AE%89%E8%A3%85/</guid>
      <description>

&lt;h3 id=&#34;0x00-关于redis:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x00 关于Redis&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;Redis和MySQL这种关系型数据库不一样，它是非关系型数据库，是日志型、Key-Value数据库，
实现了master-slave(主从)同步,数据都是缓存在内存中的,所以可高速读写,但存储成本较高,
不适合做海量数据存储。
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-安装:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x01 安装&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;可在&lt;a href=&#34;http://download.redis.io/releases/&#34;&gt;http://download.redis.io/releases/&lt;/a&gt; 下载&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ cd /opt
$ wget http://download.redis.io/releases/redis-3.2.3.tar.gz
$ tar -zxvf redis-3.2.3.tar.gz
$ cd redis-3.2.3
$ make
$ make install
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-产生的可执行文件:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x02 产生的可执行文件&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;redis-server：redis服务器启动程序
redis-cli：redis命令行工具，也可为客户端
redis-stat：redis状态检测工具
redis-benchmark：redis性能检测工具(读写)
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x03-配置文件:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x03 配置文件&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;$ vim /opt/redis-3.2.3/redis.conf
  daemonize yes  # 当值为yes时可以后台运行
  bind 127.0.0.1  # 绑定ip，配置后只接受来自该ip的请求
  port 6379  # 监听端口
  timeout 300 # 客户端连接超时时间，单位为秒
  loglevel notice  # 日志等级分为4级，debug、verbose、notice、warning
  logfile &amp;quot;/var/log/redis.log&amp;quot;  # 日志文件位置
  databases 16  # 数据库数量
  sava 900 1  # 设置数据库镜像的频率
  dbfilename dump.rdb  # 镜像备份文件的名字
  dir ./ 数据库镜像备份保存路径
  # slaveof &amp;lt;masterip&amp;gt; &amp;lt;masterport&amp;gt;  # 设置这个redis为从服务器
  # masterauth &amp;lt;master-password&amp;gt;  # 主服务器连接需要的密码验证
  # requirepass 123456  # 登陆时的密码
  maxclients 10000  # 最大连接的客户数量
  # mexmemory &amp;lt;bytes&amp;gt;  # redis能够使用的最大内存
  appendonly no  # 可以设置是否只能追加
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x04-启动测试:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x04 启动测试&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;本地启动：
$ redis-server /opt/redis-3.2.3/redis.conf  # 启动服务
$ ps -aux | grep redis
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;在另外一个机器上用redis-cli连接刚搭建的服务器：

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_install_conn_and_write_file.png&#34; alt=&#34;连接redis并创建文件&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/redis_install_visit_file.png&#34; alt=&#34;访问redis创建的文件&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x05-windows下安装redis:ccfa3b7be55824cf7252716ed708cbb8&#34;&gt;0x05 Windows下安装Redis&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;下载：&lt;a href=&#34;https://github.com/MSOpenTech/redis/releases&#34; target=&#34;_blank&#34;&gt;点此下载&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;安装后添加环境变量&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;添加为系统服务：
redis-server.exe --service-install redis.windows.conf --loglevel verbose

启动服务：
redis-server.exe --service-start

关闭服务：
redis-server.exe --service-stop

为Redis添加密码：
打开安装目录下的文件redis.windows-service.conf，
找到requirepass，配置为requirepass mypassword，然后重启redis
此时仍然可以连接上，但是执行命令时会提示没权限

带密码连接Redis：
redis-cli.exe -h 127.0.0.1 -p 6379 -a mypassword
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
  </channel>
</rss>