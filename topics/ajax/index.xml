<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ajax on </title>
    <link>http://wyb0.com/topics/ajax/</link>
    <description>Recent content in Ajax on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016-2017 Reber. All Rights Reserved.</copyright>
    <lastBuildDate>Wed, 16 Nov 2016 10:37:03 +0800</lastBuildDate>
    <atom:link href="http://wyb0.com/topics/ajax/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>AJAX与PHP</title>
      <link>http://wyb0.com/posts/AJAX%E4%B8%8EPHP/</link>
      <pubDate>Wed, 16 Nov 2016 10:37:03 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/AJAX%E4%B8%8EPHP/</guid>
      <description>

&lt;h3 id=&#34;0x00-ajax与php:8d0a9c880affaa3291d68525c07a9cdd&#34;&gt;0x00 AJAX与PHP&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;ajax.html代码如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;script&amp;gt;
    function showHint(str) {
        var xmlhttp;
        if (str.length==0) { 
            document.getElementById(&amp;quot;txtHint&amp;quot;).innerHTML=&amp;quot;&amp;quot;;
            return;
        }
        if (window.XMLHttpRequest) {
            // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
            xmlhttp=new XMLHttpRequest(); //创建对象
        } else {
            // IE6, IE5 浏览器执行代码
            xmlhttp=new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
        }
        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState==4 &amp;amp;&amp;amp; xmlhttp.status==200) {
                document.getElementById(&amp;quot;txtHint&amp;quot;).innerHTML=xmlhttp.responseText;
            }
        }
        xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;./ajax.php?q=&amp;quot;+str,true);
        xmlhttp.send();
    }
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;h3&amp;gt;在输入框中尝试输入字母 a:&amp;lt;/h3&amp;gt;
    &amp;lt;form action=&amp;quot;&amp;quot;&amp;gt; 
    输入姓名: &amp;lt;input type=&amp;quot;text&amp;quot; id=&amp;quot;txt1&amp;quot; onkeyup=&amp;quot;showHint(this.value)&amp;quot; /&amp;gt;
    &amp;lt;/form&amp;gt;
    &amp;lt;p&amp;gt;提示信息: &amp;lt;span id=&amp;quot;txtHint&amp;quot;&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;/p&amp;gt; 
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;上面的代码会完成以下的东西：

1. 在输入字母时会调用showHint()
2. showHint()创建对象
3. 定义onreadystatechange事件
4. xmlhttp.open()访问当前目录下的ajax.php来请求资源
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ajax.php代码如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;?php
// Fill up array with names
$a[]=&amp;quot;Anna&amp;quot;;
$a[]=&amp;quot;Brittany&amp;quot;;
$a[]=&amp;quot;Cinderella&amp;quot;;
$a[]=&amp;quot;Diana&amp;quot;;
$a[]=&amp;quot;Eva&amp;quot;;
$a[]=&amp;quot;Fiona&amp;quot;;
$a[]=&amp;quot;Gunda&amp;quot;;
$a[]=&amp;quot;Hege&amp;quot;;
$a[]=&amp;quot;Inga&amp;quot;;
$a[]=&amp;quot;Johanna&amp;quot;;
$a[]=&amp;quot;Kitty&amp;quot;;
$a[]=&amp;quot;Linda&amp;quot;;
$a[]=&amp;quot;Nina&amp;quot;;
$a[]=&amp;quot;Ophelia&amp;quot;;
$a[]=&amp;quot;Petunia&amp;quot;;
$a[]=&amp;quot;Amanda&amp;quot;;
$a[]=&amp;quot;Raquel&amp;quot;;
$a[]=&amp;quot;Cindy&amp;quot;;
$a[]=&amp;quot;Doris&amp;quot;;
$a[]=&amp;quot;Eve&amp;quot;;
$a[]=&amp;quot;Evita&amp;quot;;
$a[]=&amp;quot;Sunniva&amp;quot;;
$a[]=&amp;quot;Tove&amp;quot;;
$a[]=&amp;quot;Unni&amp;quot;;
$a[]=&amp;quot;Violet&amp;quot;;
$a[]=&amp;quot;Liza&amp;quot;;
$a[]=&amp;quot;Elizabeth&amp;quot;;
$a[]=&amp;quot;Ellen&amp;quot;;
$a[]=&amp;quot;Wenche&amp;quot;;
$a[]=&amp;quot;Vicky&amp;quot;;

//get the q parameter from URL
$q=$_GET[&amp;quot;q&amp;quot;];

//lookup all hints from array if length of q&amp;gt;0
if (strlen($q) &amp;gt; 0) {
    $hint=&amp;quot;&amp;quot;;
    for($i=0; $i&amp;lt;count($a); $i++) {
        if (strtolower($q)==strtolower(substr($a[$i],0,strlen($q)))) {
            if ($hint==&amp;quot;&amp;quot;) {
                $hint=$a[$i];
            } else {
                $hint=$hint.&amp;quot; , &amp;quot;.$a[$i];
            }
        }
    }
}

// Set output to &amp;quot;no suggestion&amp;quot; if no hint were found
// or to the correct values
if ($hint == &amp;quot;&amp;quot;) {
    $response=&amp;quot;no suggestion&amp;quot;;
} else {
    $response=$hint;
}

//output the response
echo $response;
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;结果如下：

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/ajax_and_php.gif&#34; alt=&#34;ajax与php&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-ajax与数据库:8d0a9c880affaa3291d68525c07a9cdd&#34;&gt;0x01 AJAX与数据库&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;可以通过xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;./ajax.php?q=&amp;quot;+str,true);的形式获取服务器数据，
那么也就可以通过这种方式获取服务端数据库中的内容
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ajax.html代码如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&amp;quot;utf-8&amp;quot;&amp;gt;
    &amp;lt;script&amp;gt;
    function showUser(str) {
        if (str==&amp;quot;&amp;quot;) {
            document.getElementById(&amp;quot;txtHint&amp;quot;).innerHTML=&amp;quot;&amp;quot;;
            return;
        } 
        if (window.XMLHttpRequest) {
            // IE7+, Firefox, Chrome, Opera, Safari 浏览器执行代码
            xmlhttp=new XMLHttpRequest();
        } else {
            // IE6, IE5 浏览器执行代码
            xmlhttp=new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
        }
        xmlhttp.onreadystatechange=function() {
            if (xmlhttp.readyState==4 &amp;amp;&amp;amp; xmlhttp.status==200){
                document.getElementById(&amp;quot;txtHint&amp;quot;).innerHTML=xmlhttp.responseText;
            }
        }
        xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;getuser.php?id=&amp;quot;+str,true);
        xmlhttp.send();
    }
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;form&amp;gt;
        &amp;lt;select name=&amp;quot;users&amp;quot; onchange=&amp;quot;showUser(this.value)&amp;quot;&amp;gt;
            &amp;lt;option value=&amp;quot;&amp;quot;&amp;gt;Select a person:&amp;lt;/option&amp;gt;
            &amp;lt;option value=&amp;quot;7&amp;quot;&amp;gt;用户1&amp;lt;/option&amp;gt;
            &amp;lt;option value=&amp;quot;8&amp;quot;&amp;gt;用户2&amp;lt;/option&amp;gt;
            &amp;lt;option value=&amp;quot;9&amp;quot;&amp;gt;用户3&amp;lt;/option&amp;gt;
        &amp;lt;/select&amp;gt;
    &amp;lt;/form&amp;gt;
    &amp;lt;br&amp;gt;
    &amp;lt;div id=&amp;quot;txtHint&amp;quot;&amp;gt;&amp;lt;b&amp;gt;Person info will be listed here.&amp;lt;/b&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;getuser.php代码如下：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;?php
    header(&amp;quot;Content-Type:text/html; charset=gbk&amp;quot;);

    $id=$_GET[&amp;quot;id&amp;quot;];

    $con = mysql_connect(&#39;localhost&#39;,&#39;root&#39;,&#39;123456&#39;);
    mysql_select_db(&amp;quot;thinkphp&amp;quot;,$con);
    $sql=&amp;quot;SELECT * FROM msg WHERE id = &#39;&amp;quot;.$id.&amp;quot;&#39;&amp;quot;;
    $result = mysql_query($sql);

    echo &amp;quot;&amp;lt;table border=&#39;1&#39;&amp;gt;
    &amp;lt;tr&amp;gt;
    &amp;lt;th&amp;gt;Id&amp;lt;/th&amp;gt;
    &amp;lt;th&amp;gt;Name&amp;lt;/th&amp;gt;
    &amp;lt;th&amp;gt;Sex&amp;lt;/th&amp;gt;
    &amp;lt;/tr&amp;gt;&amp;quot;;

    while($row = mysql_fetch_array($result)) {
        echo &amp;quot;&amp;lt;tr&amp;gt;&amp;quot;;
        echo &amp;quot;&amp;lt;td&amp;gt;&amp;quot; . $row[&#39;id&#39;] . &amp;quot;&amp;lt;/td&amp;gt;&amp;quot;;
        echo &amp;quot;&amp;lt;td&amp;gt;&amp;quot; . $row[&#39;name&#39;] . &amp;quot;&amp;lt;/td&amp;gt;&amp;quot;;
        echo &amp;quot;&amp;lt;td&amp;gt;&amp;quot; . $row[&#39;sex&#39;] . &amp;quot;&amp;lt;/td&amp;gt;&amp;quot;;
        echo &amp;quot;&amp;lt;/tr&amp;gt;&amp;quot;;
    }
    echo &amp;quot;&amp;lt;/table&amp;gt;&amp;quot;;

    mysql_close($con);
?&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;结果如下：

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/ajax_and_mysql1.png&#34; alt=&#34;ajax与mysql1&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/ajax_and_mysql2.png&#34; alt=&#34;ajax与mysql2&#34;&gt;
&lt;/div&gt;

&lt;br /&gt;&lt;br /&gt;

&lt;div class=&#34;pure-u-1&#34;&gt;
  &lt;img class=&#34;pure-img&#34; src=&#34;http://wyb0.com/img/post/ajax_and_mysql3.png&#34; alt=&#34;ajax与mysql3&#34;&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-ajax使用实例:8d0a9c880affaa3291d68525c07a9cdd&#34;&gt;0x02 AJAX使用实例&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;script&amp;gt;
        var xmlhttp;
        function loadXMLDoc(url,cfunc) {
            if (window.XMLHttpRequest) {
                // IE7+, Firefox, Chrome, Opera, Safari 代码
                xmlhttp=new XMLHttpRequest();
            } else {
                // IE6, IE5 代码
                xmlhttp=new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
            }
            xmlhttp.onreadystatechange=cfunc;
            xmlhttp.open(&amp;quot;GET&amp;quot;,url,true);
            xmlhttp.send();
        }
        function myFunction() {
            loadXMLDoc(
                &amp;quot;/try/ajax/ajax_info.txt&amp;quot;,
                function() {
                    if (xmlhttp.readyState==4 &amp;amp;&amp;amp; xmlhttp.status==200) {
                        document.getElementById(&amp;quot;myDiv&amp;quot;).innerHTML=xmlhttp.responseText;
                    }
                }
            );
        }
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;div id=&amp;quot;myDiv&amp;quot;&amp;gt;&amp;lt;h2&amp;gt;使用 AJAX 修改文本内容&amp;lt;/h2&amp;gt;&amp;lt;/div&amp;gt;
    &amp;lt;button type=&amp;quot;button&amp;quot; onclick=&amp;quot;myFunction()&amp;quot;&amp;gt;修改内容&amp;lt;/button&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>AJAX之XHR请求与响应</title>
      <link>http://wyb0.com/posts/AJAX%E4%B9%8BXHR%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%93%8D%E5%BA%94/</link>
      <pubDate>Tue, 25 Oct 2016 11:16:52 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/AJAX%E4%B9%8BXHR%E8%AF%B7%E6%B1%82%E4%B8%8E%E5%93%8D%E5%BA%94/</guid>
      <description>

&lt;h3 id=&#34;0x00-get请求:a9711465358031b2b794583ecbc5d684&#34;&gt;0x00 GET请求&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html lang=&amp;quot;en&amp;quot;&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;meta charset=&amp;quot;UTF-8&amp;quot;&amp;gt;
    &amp;lt;title&amp;gt;test&amp;lt;/title&amp;gt;
    &amp;lt;script type=&amp;quot;text/javascript&amp;quot;&amp;gt;
        function loadXMLDoc() {
            var xmlhttp;
            if (window.XMLHttpRequest) { //创建对象
                xmlhttp = new XMLHttpRequest();
            } else {
                xmlhttp = new ActiveXObjece(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
            }
        
            // readyState改变时，就会触发onreadystatechange事件
            // readyState存有XMLHttpRequest的状态，为0-4，4表示请求已完成，且响应已就绪
            // status为200代表ok，为404代表未找到页面
            xmlhttp.onreadystatechange=function() {
                if (xmlhttp.readyState==4 &amp;amp;&amp;amp; xmlhttp.status==200) {
                    // xmlhttp.responseText获取来自服务器的响应
                    document.getElementById(&amp;quot;myDiv&amp;quot;).innerHTML=xmlhttp.responseText;
                }
            }

            xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;2.html?t=&amp;quot;+Math.random(),true); //GET请求，改变readyState
            // xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;2.html?name=test&amp;amp;age=23&amp;quot;,true); //GET发送信息
            xmlhttp.send();
        }
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;h2&amp;gt;AJAX&amp;lt;/h2&amp;gt;
    &amp;lt;button type=&amp;quot;button&amp;quot; onclick=&amp;quot;loadXMLDoc()&amp;quot;&amp;gt;Request data&amp;lt;/button&amp;gt;
    &amp;lt;div id=&amp;quot;myDiv&amp;quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;点击&amp;rdquo;Request data&amp;rdquo;时就会请求服务端的2.html&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-post请求:a9711465358031b2b794583ecbc5d684&#34;&gt;0x01 POST请求&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;// 简单的POST请求
xmlhttp.open(&amp;quot;POST&amp;quot;,&amp;quot;demo_post.html&amp;quot;,true);
xmlhttp.send();

// POST数据
xmlhttp.open(&amp;quot;POST&amp;quot;,&amp;quot;ajax_test.html&amp;quot;,true);
xmlhttp.setRequestHeader(&amp;quot;Content-type&amp;quot;,&amp;quot;application/x-www-form-urlencoded&amp;quot;);
xmlhttp.send(&amp;quot;fname=Henry&amp;amp;lname=Ford&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
    <item>
      <title>AJAX初识</title>
      <link>http://wyb0.com/posts/AJAX%E5%88%9D%E8%AF%86/</link>
      <pubDate>Tue, 25 Oct 2016 00:53:13 +0800</pubDate>
      
      <guid>http://wyb0.com/posts/AJAX%E5%88%9D%E8%AF%86/</guid>
      <description>

&lt;h3 id=&#34;0x00-什么是ajax:9b34671069e155b0fab9bcb9284434b4&#34;&gt;0x00 什么是AJAX&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;AJAX全称是Asynchronous JavaScript and XML，即异步的JavaScript和XML&lt;br /&gt;
AJAX不是新的编程语言，而是一种使用现有标准的新方法。&lt;br /&gt;
AJAX可在不重新加载整个页面的情况下与服务器交换数据从而更新部分网页&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x01-示例:9b34671069e155b0fab9bcb9284434b4&#34;&gt;0x01 示例&lt;/h3&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!DOCTYPE html&amp;gt;
&amp;lt;html&amp;gt;
&amp;lt;head&amp;gt;
    &amp;lt;script&amp;gt;
    function loadXMLDoc() {
        var xmlhttp;

        if (window.XMLHttpRequest) {// code for IE7+,Firefox,Chrome,Opera,Safari
            xmlhttp=new XMLHttpRequest();
        } else {// code for IE6, IE5
          xmlhttp=new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
        }

        xmlhttp.onreadystatechange=function(){
          if (xmlhttp.readyState==4 &amp;amp;&amp;amp; xmlhttp.status==200) {
            document.getElementById(&amp;quot;myDiv&amp;quot;).innerHTML=xmlhttp.responseText;
          }
        }
        xmlhttp.open(&amp;quot;GET&amp;quot;,&amp;quot;/try/ajax/ajax_info.txt&amp;quot;,true);
        xmlhttp.send();
    }
    &amp;lt;/script&amp;gt;
&amp;lt;/head&amp;gt;
&amp;lt;body&amp;gt;
    &amp;lt;div id=&amp;quot;myDiv&amp;quot;&amp;gt;&amp;lt;h2&amp;gt;使用 AJAX 修改该文本内容&amp;lt;/h2&amp;gt;&amp;lt;/div&amp;gt;
    &amp;lt;button type=&amp;quot;button&amp;quot; onclick=&amp;quot;loadXMLDoc()&amp;quot;&amp;gt;修改内容&amp;lt;/button&amp;gt;
&amp;lt;/body&amp;gt;
&amp;lt;/html&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;当点击&amp;rdquo;修改内容&amp;rdquo;后，文本就会改变，但html页面源码没变，只向服务器请求了文本&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;0x02-关于xhr:9b34671069e155b0fab9bcb9284434b4&#34;&gt;0x02 关于XHR&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;XMLHttpRequest是AJAX的基础，就是它与后台就行交互的&lt;br /&gt;
现在大部分浏览器都支持XMLHttpRequest对象(IE5和IE6使用ActiveXObject)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;//创建对象示例
var xmlhttp;
if (window.XMLHttpRequest) {// code for IE7+,Firefox,Chrome,Opera,Safari
  xmlhttp=new XMLHttpRequest();
} else {// code for IE6, IE5
  xmlhttp=new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
</description>
    </item>
    
  </channel>
</rss>